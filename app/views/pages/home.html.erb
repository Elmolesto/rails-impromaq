

<!-- Cards OPs -->
<div class="card-deck">
  <div class="card shadow">
    <img class="card-img-top" style="max-height: 140px;" src="/lca.jpeg" alt="Card image cap">
    <div class="card-body">
      <h5 class="card-title"><i class="fas fa-poll text-success"></i> La Calera </h5>
      <h4><%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "La Calera").sum(:total), delimiter: ".", precision: 0)%>

      </h4>
      <p class="card-text">
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "La Calera").where(op: [nil, ""]).sum(:total), delimiter: ".", precision: 0) %> Sin OP<br>
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "La Calera").where.not(op: true).sum(:total), delimiter: ".", precision: 0) %> Con OP
      </p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Pendiente de pago al <%= Date.today.to_s(:long)%></small>
    </div>
  </div>
  <div class="card shadow">
    <img class="card-img-top" style="max-height: 140px;" src="/vts.jpeg" alt="Card image cap">
    <div class="card-body">
      <h5 class="card-title"><i class="fas fa-poll text-success"></i> Ventanas </h5>
      <h4>
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "Ventanas").sum(:total), delimiter: ".", precision: 0)%>
      </h4>
      <p class="card-text">
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "Ventanas").where(op: [nil, ""]).sum(:total), delimiter: ".", precision: 0) %> Sin OP<br>
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "Ventanas").where.not(op: true).sum(:total), delimiter: ".", precision: 0) %> Con OP
      </p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Pendiente de pago al <%= Date.today.to_s(:long)%></small>
    </div>
  </div>
  <div class="card shadow">
    <img class="card-img-top" style="max-height: 140px;" src="/ptm.jpg" alt="Card image cap">
    <div class="card-body">
      <h5 class="card-title"><i class="fas fa-poll text-success"></i> Puerto Montt </h5>
      <h4>
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "P.Montt").sum(:total), delimiter: ".", precision: 0)%>
      </h4>
      <p class="card-text">
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "P.Montt").where(op: [nil, ""]).sum(:total), delimiter: ".", precision: 0) %> Sin OP<br>
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "P.Montt").where.not(op: true).sum(:total), delimiter: ".", precision: 0) %> Con OP
      </p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Pendiente de pago al <%= Date.today.to_s(:long)%></small>
    </div>
  </div>
  <div class="card shadow">
    <img class="card-img-top" style="max-height: 140px;" src="/pam.jpg" alt="Card image cap">
    <div class="card-body">
      <h5 class="card-title"><i class="fas fa-poll text-success"></i> Punta Arenas </h5>
      <h4>
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "P.Arenas").sum(:total), delimiter: ".", precision: 0)%>
      </h4>
      <p class="card-text">
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "P.Arenas").where(op: [nil, ""]).sum(:total), delimiter: ".", precision: 0) %> Sin OP<br>
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "P.Arenas").where.not(op: true).sum(:total), delimiter: ".", precision: 0) %> Con OP
      </p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Pendiente de pago al <%= Date.today.to_s(:long)%></small>
    </div>
  </div>
</div>
<!-- Mantencion -->
<div class="card-deck">
  <div class="card shadow">
    <div class="card-body">
      <h5 class="card-title"><i class="fas fa-wrench text-success"></i> La Calera </h5>

    </div>
    <div class="card-footer">
      <small class="text-muted">Ultimo checklist realizado <%#= Date.today.to_s(:long)%></small>
    </div>
  </div>
  <div class="card shadow">
    <div class="card-body">
      <h5 class="card-title"><i class="fas fa-wrench text-success"></i> Ventanas </h5>
      <p class="card-text">
        <i class="far fa-clock"></i>
        <%= Equipo.where(nombre: "BRR17").last.horometro %>
        <strong> Barredora</strong>
        <i class="fas fa-cog"></i> 0
        <!-- <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "Ventanas").where(op: [nil, ""]).sum(:total), delimiter: ".", precision: 0) %> Sin OP<br>
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "Ventanas").where.not(op: true).sum(:total), delimiter: ".", precision: 0) %> Con OP -->
      </p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Ultimo checklist <%= Equipo.where(c17: "VTS").last.created_at.strftime("%d-%m-%Y") %> </small>
    </div>
  </div>
  <div class="card shadow">
    <div class="card-body">
      <h5 class="card-title"><i class="fas fa-wrench text-success"></i> Puerto Montt </h5>
      <p class="card-text">
        <i class="far fa-clock"></i>
        <%= Equipo.where(nombre: "HQPTA31").last.horometro %>
        <strong> Horquilla 31 7t</strong>
        <i class="fas fa-cog"></i> 0 <br>
        <i class="far fa-clock"></i>
        <%= Equipo.where(nombre: "HQPTA32").last.horometro %>
        <strong> Horquilla 32 7t</strong>
        <i class="fas fa-cog"></i> 0 <br>
        <i class="far fa-clock"></i>
        <%= Equipo.where(nombre: "HQPTA33").last.horometro %>
        <strong> Horquilla 33 3t</strong>
        <i class="fas fa-cog"></i> 0 <br>
        <i class="far fa-clock"></i>
        <%= Equipo.where(nombre: "OL03").last.horometro %>
        <strong> Cargador frontal</strong>
        <i class="fas fa-cog"></i> 0 <br>
        <!-- <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "P.Montt").where(op: [nil, ""]).sum(:total), delimiter: ".", precision: 0) %> Sin OP<br>
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "P.Montt").where.not(op: true).sum(:total), delimiter: ".", precision: 0) %> Con OP -->
      </p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Ultimo checklist <%= Equipo.where(c17: "PTM").last.created_at.strftime("%d-%m-%Y") %></small>

    </div>
  </div>
  <div class="card shadow">
    <div class="card-body">
      <h5 class="card-title"><i class="fas fa-wrench text-success"></i> Punta Arenas </h5>
      <p class="card-text">
        <!-- <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "P.Arenas").where(op: [nil, ""]).sum(:total), delimiter: ".", precision: 0) %> Sin OP<br>
        <%= number_to_currency(Trabajo.where(avance: "Terminado").where(planta: "P.Arenas").where.not(op: true).sum(:total), delimiter: ".", precision: 0) %> Con OP -->
      </p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Ultimo checklist realizado <%#= Date.today.to_s(:long)%></small>
    </div>
  </div>
</div>
<% if current_user.superadmin_role?  %>
    <!-- Main content -->
    <section>
      <div class="container-fluid">
        <!-- Info boxes -->
        <div class="row">
          <div class="col-md-12">
            <div class="card shadow">
              <div class="card-header">
                <h4 class="card-title">Producción sacos por turno</h5>


              </div>
              <!-- /.card-header -->
              <div class="card-body">
                <div class="row">
                  <div class="col-md-8">
                    <p class="text-center">
                      <strong>Producción: 23 de Marzo, 2020 al  30 de Marzo, 2020</strong>
                    </p>

                    <div class="chart">
                      <!-- Sales Chart Canvas -->
                      <canvas id="myChart" height="120" style="height: 180px;"></canvas>
                    </div>
                    <!-- /.chart-responsive -->
                  </div>
                  <!-- /.col -->
                  <div class="col-md-4">
                    <p class="text-center">
                      <strong>Metas</strong>
                    </p>

                    <div class="progress-group">
                      Turno A
                      <span class="float-right"><b>10000</b>/1200</span>
                      <div class="progress progress-sm">
                        <div class="progress-bar bg-primary" style="width: 80%"></div>
                      </div>
                    </div>
                    <!-- /.progress-group -->

                    <div class="progress-group">
                      Turno B
                      <span class="float-right"><b>710</b>/12000</span>
                      <div class="progress progress-sm">
                        <div class="progress-bar bg-danger" style="width: 75%"></div>
                      </div>
                    </div>

                    <!-- /.progress-group -->
                    <div class="progress-group">
                      <span class="progress-text">Turno C</span>
                      <span class="float-right"><b>880</b>/12000</span>
                      <div class="progress progress-sm">
                        <div class="progress-bar bg-success" style="width: 60%"></div>
                      </div>
                    </div>

                    <!-- /.progress-group -->

                    <!-- /.progress-group -->
                  </div>
                  <!-- /.col -->
                </div>
                <!-- /.row -->
              </div>
              <!-- ./card-body -->
              <div class="card-footer">
                <div class="row">
                  <div class="col-sm-3 col-6">
                    <div class="description-block border-right">
                      <span class="description-percentage text-success"><i class="fas fa-caret-up "></i> 17%</span>
                      <h5 class="description-header">1.200 t</h5>
                      <span class="description-text">Stock promedio</span>
                    </div>
                    <!-- /.description-block -->
                  </div>
                  <!-- /.col -->
                  <div class="col-sm-3 col-6">
                    <div class="description-block border-right">
                      <span class="description-percentage text-warning"><i class="fas fa-caret-left"></i> 0%</span>
                      <h5 class="description-header">800 t</h5>
                      <span class="description-text">Despacho  promedio</span>
                    </div>
                    <!-- /.description-block -->
                  </div>
                  <!-- /.col -->
                  <div class="col-sm-3 col-6">
                    <div class="description-block border-right">
                      <span class="description-percentage text-success"><i class="fas fa-caret-up"></i> 20%</span>
                      <h5 class="description-header">1.200 t </h5>
                      <span class="description-text">Produccion promedio</span>
                    </div>
                    <!-- /.description-block -->
                  </div>
                  <!-- /.col -->
                  <div class="col-sm-3 col-6">
                    <div class="description-block">
                      <span class="description-percentage text-danger"><i class="fas fa-caret-down"></i> 18%</span>
                      <h5 class="description-header">55 de 76</h5>
                      <span class="description-text">Tareas mantención</span>
                    </div>
                    <!-- /.description-block -->
                  </div>
                </div>
                <!-- /.row -->
              </div>
              <!-- /.card-footer -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
        </div>
		<br>


            <!-- TABLE: LATEST ORDERS -->
            <div class="card">
              <div class="card-header border-transparent">
                <h3 class="card-title h2"><strong>Trabajos en ejecución</strong></h3>

                <div class="card-tools">

                </div>
              </div>
              <!-- /.card-header -->
              <div class="card-body p-0">
                <div class="table-responsive">
                  <table class="table m-0">
                    <thead>
                    <tr>
                      <th>OT</th>
                      <th>Descripcion</th>
                      <th>Status</th>
                      <th>Otros</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                      <td><a href="pages/examples/invoice.html">OR9842</a></td>
                      <td>Fabricacion tolva</td>
                      <td><span class="badge badge-success">Programado</span></td>
                      <td>
                        <div class="sparkbar" data-color="#00a65a" data-height="20">Alzahombre programado</div>
                      </td>
                    </tr>
                    <tr>
                      <td><a href="pages/examples/invoice.html">OR1848</a></td>
                      <td>Suministro EPP a planta</td>
                      <td><span class="badge badge-warning">Compras</span></td>
                      <td>
                        <div class="sparkbar" data-color="#f39c12" data-height="20">Compras perfiles pendientes</div>
                      </td>
                    </tr>
                    <tr>
                      <td><a href="pages/examples/invoice.html">OR7429</a></td>
                      <td>Maestranza villegas</td>
                      <td><span class="badge badge-danger">En ejecución</span></td>
                      <td>
                        <div class="sparkbar" data-color="#f56954" data-height="20"></div>
                      </td>
                    </tr>
                    <tr>
                      <td><a href="pages/examples/invoice.html">OR7429</a></td>
                      <td>Repuestos haver</td>
                      <td><span class="badge badge-info">Adjudicado</span></td>
                      <td>
                        <div class="sparkbar" data-color="#00c0ef" data-height="20"></div>
                      </td>
                    </tr>
                    <tr>
                      <td><a href="pages/examples/invoice.html">OR1848</a></td>
                      <td>Torque molino 19</td>
                      <td><span class="badge badge-warning">Compras</span></td>
                      <td>
                        <div class="sparkbar" data-color="#f39c12" data-height="20"></div>
                      </td>
                    </tr>
                    <tr>
                      <td><a href="pages/examples/invoice.html">OR7429</a></td>
                      <td>Alineamiento molino</td>
                      <td><span class="badge badge-danger">En ejecución</span></td>
                      <td>
                        <div class="sparkbar" data-color="#f56954" data-height="20"></div>
                      </td>
                    </tr>
                    <tr>
                      <td><a href="pages/examples/invoice.html">OR9842</a></td>
                      <td>Planchas techo</td>
                      <td><span class="badge badge-success">Programado</span></td>
                      <td>
                        <div class="sparkbar" data-color="#00a65a" data-height="20"></div>
                      </td>
                    </tr>
                    </tbody>
                  </table>
                </div>
                <!-- /.table-responsive -->
              </div>
              <!-- /.card-body -->

              <!-- /.card-footer -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
  <!-- /.content-wrapper -->
 </main>
  <!-- page-content" -->
</div>
<!-- page-wrapper -->
</div>


  <% end %>

	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>


	<script>
		var ctx = document.getElementById('myChart').getContext('2d');
		var chart = new Chart(ctx, {
		    // The type of chart we want to create
		    type: 'line',

		    // The data for our dataset
		    data: {
		        labels: ['Lunes', 'Martes', 'Miercoles', 'Jueves', 'Viernes', 'Sabado', 'Domingo'],
		        datasets: [{
		            label: 'Turno A',
		            backgroundColor: 'rgb(44, 166, 77, 0.3)',
		            borderColor: 'rgb(44, 166, 77, 0.3)',
		            data: [5, 10, 15, 2, 12, 15, 0]
		        },{
		            label: 'Turno B',
		            backgroundColor: 'rgb(222, 51, 69, 0.3)',
		            borderColor: 'rgb(222, 51, 69, 0.3)',
		            data: [10, 2, 7, 20, 18, 15, 3]
		        }, {
		            label: 'Turno C',
		            backgroundColor: 'rgb(0, 131, 251, 0.3)',
		            borderColor: 'rgb(0, 131, 251, 0.3)',
		            data: [12, 8, 7, 5, 20, 12, 3]
		        }]
		    },

		    // Configuration options go here
		    options: {}
		});

	</script>
